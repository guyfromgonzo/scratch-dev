{
  // Dev Container configuration for Java development with JDK 21, Spring Boot, and Maven
  "name": "Java Development Environment",
  
  // Use Microsoft's official Java dev container image
  "image": "mcr.microsoft.com/devcontainers/java:21-jdk-bookworm",
  
  // Features to install in the container (Git is already included in base image)
  "features": {
    // Maven is already included in the Java base image, so no additional features needed
  },
  
  // VS Code extensions to install automatically
  "customizations": {
    "vscode": {
      "extensions": [
        // Essential Java development extensions
        // Java Extension Pack includes: Language Support, Debugger, Test Runner, Maven, Project Manager, and Dependency Viewer
        "vscjava.vscode-java-pack",
        
        // Spring Boot specific extensions
        "vmware.vscode-spring-boot",
        "vscjava.vscode-spring-initializr",
        "vscjava.vscode-spring-boot-dashboard",
        
        // Additional helpful extensions
        "redhat.vscode-xml",
        "gabrielbb.vscode-lombok",
        "sonarsource.sonarlint-vscode"
      ],
      
      // VS Code workspace settings optimized for Java development
      "settings": {
        // Java configuration (using default paths from base image)
        "java.configuration.runtimes": [
          {
            "name": "JavaSE-21",
            "path": "/usr/lib/jvm/msopenjdk-current",
            "default": true
          }
        ],
        
        // Maven configuration (using default path from base image)
        "maven.terminal.useJavaHome": true,
        
        // Spring Boot configuration
        "spring-boot.ls.problem.application-properties.enabled": true,
        "spring.initializr.defaultLanguage": "Java",
        
        // Editor settings for Java
        "editor.tabSize": 4,
        "editor.insertSpaces": true,
        "files.exclude": {
          "**/target": true,
          "**/.classpath": true,
          "**/.project": true,
          "**/.settings": true,
          "**/.factorypath": true
        }
      }
    }
  },
  
  // Ports to forward automatically
  "forwardPorts": [
    // Spring Boot default port
    8080,
    // Java debug port
    5005
  ],
  
  // Port attributes for better handling
  "portsAttributes": {
    "8080": {
      "label": "Spring Boot App",
      "onAutoForward": "openPreview"
    },
    "5005": {
      "label": "Java Debug Port",
      "onAutoForward": "ignore"
    }
  },
  
  // Commands to run after container creation
  "postCreateCommand": "echo 'Java Development Environment Ready!'",
  
  // Commands to run when starting the container
  "postStartCommand": [
    "bash",
    "-c",
    "if [ -f 'pom.xml' ]; then echo 'Found pom.xml, downloading dependencies...' && mvn dependency:resolve && mvn compile; else echo 'No pom.xml found. Ready to create a new Maven project.'; fi && echo 'Maven version:' && mvn -version && echo '' && echo 'Useful Maven commands:' && echo '  mvn spring-boot:run    - Run Spring Boot application' && echo '  mvn clean install      - Clean and build project' && echo '  mvn test              - Run tests'"
  ],
  
  // Container user (use default vscode user)
  "remoteUser": "vscode",
  
  // Mount the local .m2 directory for Maven cache persistence
  "mounts": [
    "source=${localWorkspaceFolder}/.devcontainer/.m2,target=/home/vscode/.m2,type=bind,consistency=cached"
  ],
  
  // Environment variables (using paths from Microsoft's Java base image)
  "containerEnv": {
    "JAVA_HOME": "/usr/lib/jvm/msopenjdk-current"
  }
}
